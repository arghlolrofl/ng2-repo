<section class="sectiontemplate">
  <h4>
    <i class="icon-class icon-tool"></i>
    {{ 'PRODUCT_CALCULATION_HEADLINE' | translate }}
  </h4>
  <form [ngFormModel]="productCalculationForm">
    <div class="row">
      <div class="col-input small-input">
        <div class="field-container text-field">
          <input type="text"
                 placeholder="{{ 'PRODUCT_CALCULATION_WEIGHT_PLACEHOLDER' | translate }}"
                 tabindex="10"
                 ngControl="weight"
                 [class.error]="!productCalculationForm.controls['weight'].valid && productCalculationForm.controls['weight'].touched"
                 (keyup.esc)="clearWeight()">
          <button class="clear-submit"
                  (click)="clearWeight()">
            <span class="icon-close"></span>
          </button>
        </div>
      </div>

      <div class="col-button">
        <div class="field-container box-icon">
          <button>
            <span class="icon-weight"></span>
          </button>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-input small-input">
        <div class="field-container text-field"
             [class.disabled]="isDocument">
          <input type="text"
                 placeholder="{{ 'PRODUCT_CALCULATION_LENGTH_PLACEHOLDER' | translate }}"
                 tabindex="11"
                 ngControl="length"
                 [class.error]="!productCalculationForm.controls['length'].valid && productCalculationForm.controls['length'].touched"
                 [disabled]="isDocument"
                 (keyup.esc)="clearLength()">
          <button class="clear-submit"
                  (click)="clearLength()"
                  [disabled]="isDocument">
            <span class="icon-close"></span>
          </button>
        </div>

        <div class="field-container text-field"
             [class.disabled]="isDocument">
          <input type="text"
                 placeholder="{{ 'PRODUCT_CALCULATION_WIDTH_PLACEHOLDER' | translate }}"
                 tabindex="12"
                 ngControl="width"
                 [class.error]="!productCalculationForm.controls['width'].valid && productCalculationForm.controls['width'].touched"
                 [disabled]="isDocument"
                 (keyup.esc)="clearWidth()">
          <button class="clear-submit"
                  (click)="clearWidth()"
                  [disabled]="isDocument">
            <span class="icon-close"></span>
          </button>
        </div>

        <div class="field-container text-field"
             [class.disabled]="isDocument">
          <input type="text"
                 placeholder="{{ 'PRODUCT_CALCULATION_HEIGHT_PLACEHOLDER' | translate }}"
                 tabindex="13"
                 ngControl="height"
                 [class.error]="!productCalculationForm.controls['height'].valid && productCalculationForm.controls['height'].touched"
                 [disabled]="isDocument"
                 (keyup.esc)="clearHeight()">
          <button class="clear-submit"
                  (click)="clearHeight()"
                  [disabled]="isDocument">
            <span class="icon-close"></span>
          </button>
        </div>
      </div>
      <div class="col-button">
        <div class="field-container box-icon">
          <button type="submit"
                  (click)="changeIsDocument()">
            <span class="icon-interface"></span>
          </button>
        </div>
      </div>
    </div>

    <fp-shipping-product-calculation-shortcuts
        (shortcutChange)="shortcutSelected($event)"></fp-shipping-product-calculation-shortcuts>

    <div class="row">
      <div class="field-container box-info">
        <span>{{ 'PRODUCT_CALCULATION_PARCEL_WEIGHT_DIMENSION_INFO' | translate }}</span>
        <hr>
        <span>{{weight.Value}}{{ 'KG' | translate }} - {{dimensions.Height}}{{ 'CM' | translate }} x {{dimensions.Width}}{{ 'CM' | translate }} x {{dimensions.Length}}{{ 'CM' | translate }}</span>
      </div>

      <button type="submit"
              class="button color"
              [disabled]="!canCalculate()"
              (click)="recalculateProduct()">
        <span>{{ 'PRODUCT_CALCULATION_CALCULATE_BUTTON' | translate }}</span>
      </button>
    </div>

    <div class="row">
      <button class="box-package"
              [disabled]="!parcel"
              (click)="modalProductSelect.open()">
        <span *ngIf="parcel">{{parcel.Name}}</span>
        <span *ngIf="parcel" class="price">{{parcel.Price.Total | currency:'USD':true:'1.2-2'}}</span>
        <span *ngIf="parcel">{{parcel.ExpectedTransitTime}} business days {{parcel.GuaranteedDelivery ? '(Guaranteed)' : ''}}*</span>
        <span *ngIf="!parcel">{{ 'PRODUCT_CALCULATION_PARCEL_NOT_AVAILABLE' | translate }}</span>
      </button>
    </div>

  </form>
</section>

<modal #modalProductSelect>
  <modal-header>
    <div class="row">
      <div class="col-md-12">
        <h4>{{ 'PRODUCT_CALCULATION_SELECT_PRODUCT' | translate }}</h4>
      </div>
    </div>
  </modal-header>
  <modal-body>
    <div class="row">
      <button *ngFor="let parcel of parcelSuggestions"
              class="box-package"
              (click)="parcelSelected(parcel)">
        <span>{{parcel.Name}}</span>
        <span class="price">{{parcel.Price.Total | currency:'USD':true:'1.2-2'}}</span>
        <span>{{parcel.ExpectedTransitTime}} {{ 'PRODUCT_CALCULATION_BUSINESS_DAYS' | translate }} {{parcel.GuaranteedDelivery ? '(Guaranteed)' : ''}}*</span>
      </button>
    </div>
  </modal-body>

  <modal-footer>
    <div class="row">
      <div class="col-sm-12">
        <button class="button popup"
                (click)="modalProductSelect.close()">
          <span>{{ 'MODAL_CLOSE' | translate }}</span>
        </button>
      </div>
    </div>
  </modal-footer>
</modal>